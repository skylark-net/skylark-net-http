/**
 * skylark-net-http - The skylark http  library.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(factory,globals){var define=globals.define,require=globals.require,isAmd="function"==typeof define&&define.amd,isCmd=!isAmd&&"undefined"!=typeof exports;if(!isAmd&&!define){var map={};define=globals.define=function(t,r,e){"function"==typeof e?(map[t]={factory:e,deps:r.map(function(r){return function(t,r){if("."!==t[0])return t;var e=r.split("/"),n=t.split("/");e.pop();for(var i=0;i<n.length;i++)"."!=n[i]&&(".."==n[i]?e.pop():e.push(n[i]));return e.join("/")}(r,t)}),resolved:!1,exports:null},require(t)):map[t]={factory:null,resolved:!0,exports:e}},require=globals.require=function(t){if(!map.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var r=map[t];if(!r.resolved){var e=[];r.deps.forEach(function(t){e.push(require(t))}),r.exports=r.factory.apply(globals,e)||null,r.resolved=!0}return r.exports}}if(!define)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(define,require){define("skylark-langx-ns/_attach",[],function(){return function(t,r,e){"string"==typeof r&&(r=r.split("."));for(var n=r.length,i=t,o=0,a=r[o++];o<n;)i=i[a]=i[a]||{},a=r[o++];return i[a]=e}}),define("skylark-langx-ns/ns",["./_attach"],function(t){var r={attach:function(e,n){return t(r,e,n)}};return r}),define("skylark-net-http/http",["skylark-langx-ns/ns"],function(t){return t.attach("net.http",{})}),define("skylark-langx-ns/main",["./ns"],function(t){return t}),define("skylark-langx-ns",["skylark-langx-ns/main"],function(t){return t}),define("skylark-langx-types/types",["skylark-langx-ns"],function(t){var r,e={}.toString,n=(r={},"Boolean Number String Function Array Date RegExp Object Error Symbol".split(" ").forEach(function(t){r["[object "+t+"]"]=t.toLowerCase()}),function(t){return null==t?String(t):r[e.call(t)]||"object"});function i(t){var r;for(r in t)if(null!==t[r])return!1;return!0}function o(t){return"function"==n(t)}function a(t){return t&&t.nodeType}function s(t){return"number"==typeof t}function u(t){return"object"==n(t)}function l(t){return"string"==typeof t}function c(t){return t&&t==t.window}return t.attach("langx.types",{isArray:function(t){return t&&t.constructor===Array},isArrayLike:function(t){return!l(t)&&!a(t)&&"number"==typeof t.length&&!o(t)},isBoolean:function(t){return"boolean"==typeof t},isDefined:function(t){return void 0!==t},isDocument:function(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE},isEmpty:i,isEmptyObject:i,isFunction:o,isHtmlNode:a,isNull:function(t){return"null"===n(t)},isNumber:s,isNumeric:s,isObject:u,isPlainObject:function(t){return u(t)&&!c(t)&&Object.getPrototypeOf(t)==Object.prototype},isString:l,isSameOrigin:function(t){if(t){var r=location.protocol+"//"+location.hostname;return location.port&&(r+=":"+location.port),t.startsWith(r)}},isSymbol:function(t){return"symbol"==typeof t||isObjectLike(t)&&objectToString.call(t)==symbolTag},isUndefined:function(t){return void 0===t},isWindow:c,type:n})}),define("skylark-langx-types/main",["./types"],function(t){return t}),define("skylark-langx-types",["skylark-langx-types/main"],function(t){return t}),define("skylark-langx-numbers/numbers",["skylark-langx-ns","skylark-langx-types"],function(t,r){var e=r.isObject,n=r.isSymbol,i=1/0,o=1.7976931348623157e308,a=NaN,s=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,c=/^0o[0-7]+$/i,f=parseInt;function p(t){if(!t)return 0===t?t:0;if((t=h(t))===i||t===-i){var r=t<0?-1:1;return r*o}return t==t?t:0}function h(t){if("number"==typeof t)return t;if(n(t))return a;if(e(t)){var r="function"==typeof t.valueOf?t.valueOf():t;t=e(r)?r+"":r}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(s,"");var i=l.test(t);return i||c.test(t)?f(t.slice(2),i?2:8):u.test(t)?a:+t}return t.attach("langx.numbers",{toFinite:p,toNumber:h,toInteger:function(t){var r=p(t),e=r%1;return r==r?e?r-e:r:0}})}),define("skylark-langx-numbers/main",["./numbers"],function(t){return t}),define("skylark-langx-numbers",["skylark-langx-numbers/main"],function(t){return t}),define("skylark-langx-objects/objects",["skylark-langx-ns/ns","skylark-langx-ns/_attach","skylark-langx-types","skylark-langx-numbers"],function(t,r,e,n){var i,o,a=Object.prototype.hasOwnProperty,s=Array.prototype.slice,u=e.isBoolean,l=e.isFunction,c=e.isObject,f=e.isPlainObject,p=e.isArray,h=e.isArrayLike,y=e.isString,d=n.toInteger;var v,x,g="undefined"!=typeof Symbol?Symbol.prototype:null;function m(t){if(!c(t))return[];var r=[];for(var e in t)r.push(e);return r}function k(t,r){if(!p(r))return null!=t&&a.call(t,r);for(var e=r.length,n=0;n<e;n++){var i=r[n];if(null==t||!a.call(t,i))return!1;t=t[i]}return!!e}function b(t,r,e,n){for(var i in r)n&&void 0!==t[i]||(e&&(f(r[i])||p(r[i]))?(f(r[i])&&!f(t[i])&&(t[i]={}),p(r[i])&&!p(t[i])&&(t[i]=[]),b(t[i],r[i],e,n)):void 0!==r[i]&&(t[i]=r[i]));return t}function _(t){var r=s.call(arguments,0),e=r.shift(),n=!1;return u(r[r.length-1])&&(n=r.pop()),{target:e,sources:r,deep:n}}function j(){var t=_.apply(this,arguments);return t.sources.forEach(function(r){b(t.target,r,t.deep,!1)}),t.target}function T(t){for(var r=m(t),e=r.length,n=Array(e),i=0;i<e;i++)n[i]=t[r[i]];return n}return i=function(t,r,e,n){if(t===r)return 0!==t||1/t==1/r;if(null==t||null==r)return!1;if(t!=t)return r!=r;var i=typeof t;return("function"===i||"object"===i||"object"==typeof r)&&o(t,r,e,n)},o=function(t,r,e,n){var o=toString.call(t);if(o!==toString.call(r))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+r;case"[object Number]":return+t!=+t?+r!=+r:0==+t?1/+t==1/r:+t==+r;case"[object Date]":case"[object Boolean]":return+t==+r;case"[object Symbol]":return g.valueOf.call(t)===g.valueOf.call(r)}var a="[object Array]"===o;if(!a){if("object"!=typeof t||"object"!=typeof r)return!1;var s=t.constructor,u=r.constructor;if(s!==u&&!(l(s)&&s instanceof s&&l(u)&&u instanceof u)&&"constructor"in t&&"constructor"in r)return!1}e=e||[],n=n||[];for(var c=e.length;c--;)if(e[c]===t)return n[c]===r;if(e.push(t),n.push(r),a){if((c=t.length)!==r.length)return!1;for(;c--;)if(!i(t[c],r[c],e,n))return!1}else{var f,p=Object.keys(t);if(c=p.length,Object.keys(r).length!==c)return!1;for(;c--;)if(f=p[c],void 0===r[f]||!i(t[f],r[f],e,n))return!1}return e.pop(),n.pop(),!0},t.attach("langx.objects",{allKeys:m,attach:r,clone:function t(r,e){var n;if(void 0===r||null===r)n=r;else if(e&&r.clone)n=r.clone();else if(p(r)){n=[];for(var i=0;i<r.length;i++)n.push(t(r[i]))}else if(f(r))for(var o in n={},r)n[o]=t(r[o]);else n=r;return n},defaults:(v=m,x=!0,function(t){var r=arguments.length;if(x&&(t=Object(t)),r<2||null==t)return t;for(var e=1;e<r;e++)for(var n=arguments[e],i=v(n),o=i.length,a=0;a<o;a++){var s=i[a];x&&void 0!==t[s]||(t[s]=n[s])}return t}),each:function(t,r){var e,n,i,o;if(t)if(void 0===(e=t.length)){for(n in t)if(t.hasOwnProperty(n)&&(o=t[n],!1===r.call(o,n,o)))break}else for(i=0;i<e&&(o=t[i],!1!==r.call(o,i,o));i++);return this},extend:function(t){var r,e=s.call(arguments,1);"boolean"==typeof t&&(r=t,t=e.shift());0==e.length&&(e=[t],t=this);return e.forEach(function(e){j(t,e,r)}),t},has:k,isEqual:function(t,r){return i(t,r)},includes:function(t,r,e,n){t=h(t)?t:T(t),e=e&&!n?d(e):0;var i=t.length;e<0&&(e=nativeMax(i+e,0));return y(t)?e<=i&&t.indexOf(r,e)>-1:!!i&&baseIndexOf(t,r,e)>-1},isMatch:function(t,r){var e=e(r),n=e.length;if(null==t)return!n;for(var i=Object(t),o=0;o<n;o++){var a=e[o];if(r[a]!==i[a]||!(a in i))return!1}return!0},keys:function(t){if(c(t))return[];var r=[];for(var e in t)k(t,e)&&r.push(e);return r},mixin:j,omit:function(t,r,e){if(!t)return null;for(var n=j({},t),i=1;i<arguments.length;i++){var o=arguments[i];o in t&&delete n[o]}return n},pick:function(t,r,e){if(!t)return null;for(var n={},i=1;i<arguments.length;i++){var o=arguments[i];o in t&&(n[o]=t[o])}return n},removeItem:function(t,r){if(p(t)){var e=t.indexOf(r);-1!=e&&t.splice(e,1)}else if(f(t))for(var n in t)if(t[n]==r){delete t[n];break}return this},result:function(t,r,e){p(r)||(r=r.split("."));var n=r.length;if(!n)return l(e)?e.call(t):e;for(var i=0;i<n;i++){var o=null==t?void 0:t[r[i]];void 0===o&&(o=e,i=n),t=l(o)?o.call(t):o}return t},safeMixin:function(){var t=_.apply(this,arguments);return t.sources.forEach(function(r){b(t.target,r,t.deep,!0)}),t.target},values:T})}),define("skylark-langx-objects/main",["./objects"],function(t){return t}),define("skylark-langx-objects",["skylark-langx-objects/main"],function(t){return t}),define("skylark-langx-arrays/arrays",["skylark-langx-ns/ns","skylark-langx-types","skylark-langx-objects"],function(t,r,e){var n=Array.prototype.filter,i=r.isArrayLike;function o(t,r,e,n){for(var i=t.length,o=e+(n?1:-1);n?o--:++o<i;)if(r(t[o],o,t))return o;return-1}function a(t){return t!=t}function s(t){if(i(t)){for(var r=[],e=0;e<t.length;e++){var n=t[e];if(i(n))for(var o=0;o<n.length;o++)r.push(n[o]);else r.push(n)}return r}return t}return t.attach("langx.arrays",{baseFindIndex:o,baseIndexOf:function(t,r,e){if(r!=r)return o(t,a,e);var n=e-1,i=t.length;for(;++n<i;)if(t[n]===r)return n;return-1},compact:function(t){return n.call(t,function(t){return null!=t})},first:function(t,r){return r?t.slice(0,r):t[0]},filter:function(t,r){return n.call(t,r)},flatten:s,grep:function(t,r){var n=[];return e.each(t,function(t,e){r(e,t)&&n.push(e)}),n},inArray:function(t,r){if(!r)return-1;var e;if(r.indexOf)return r.indexOf(t);e=r.length;for(;e--;)if(r[e]===t)return e;return-1},makeArray:function(t,r,e){if(i(t))return(e||[]).concat(Array.prototype.slice.call(t,r||0));return[t]},merge:function(t,r){var e=r.length,n=t.length,i=0;if("number"==typeof e)for(;i<e;i++)t[n++]=r[i];else for(;void 0!==r[i];)t[n++]=r[i++];return t.length=n,t},forEach:function(t,r){if(t.forEach)return t.forEach(r);for(var e=0;e<t.length;e++)r(t[e],e)},map:function(t,r){var e,n,o,a=[];if(i(t))for(n=0;n<t.length;n++)null!=(e=r.call(t[n],t[n],n))&&a.push(e);else for(o in t)null!=(e=r.call(t[o],t[o],o))&&a.push(e);return s(a)},reduce:function(t,r,e){return Array.prototype.reduce.call(t,r,e)},uniq:function(t){return n.call(t,function(r,e){return t.indexOf(r)==e})}})}),define("skylark-langx-arrays/main",["./arrays"],function(t){return t}),define("skylark-langx-arrays",["skylark-langx-arrays/main"],function(t){return t}),define("skylark-langx-funcs/funcs",["skylark-langx-ns/ns","skylark-langx-types","skylark-langx-objects"],function(t,r,e){var n=e.mixin,i=Array.prototype.slice,o=r.isFunction,a=r.isString;var s=function(){function t(){}return function(r,e){t.prototype=r;var i=new t;return t.prototype=null,e&&n(i,e),i}}(),u={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};return t.attach("langx.funcs",{debounce:function(t,r){var e;return function(){var n=this,i=arguments;e&&clearTimeout(e),e=setTimeout(function(){e=null,t.apply(n,i)},r)}},delegate:s,defer:function(t){requestAnimationFrame?requestAnimationFrame(t):setTimeoutout(t);return this},noop:function(){},proxy:function t(r,e){var n=2 in arguments&&i.call(arguments,2);if(o(r)){return function(){return r.apply(e,n?n.concat(i.call(arguments)):arguments)}}if(a(e))return n?(n.unshift(r[e],r),t.apply(null,n)):t(r[e],r);throw new TypeError("expected function")},returnTrue:function(){return!0},returnFalse:function(){return!1},templateSettings:u,template:function(t,r,n){!r&&n&&(r=n);r=e.defaults({},r,u);var i,o=RegExp([(r.escape||noMatch).source,(r.interpolate||noMatch).source,(r.evaluate||noMatch).source].join("|")+"|$","g"),a=0,s="__p+='";t.replace(o,function(r,e,n,i,o){return s+=t.slice(a,o).replace(escapeRegExp,escapeChar),a=o+r.length,e?s+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'":n?s+="'+\n((__t=("+n+"))==null?'':__t)+\n'":i&&(s+="';\n"+i+"\n__p+='"),r}),s+="';\n",r.variable||(s="with(obj||{}){\n"+s+"}\n");s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{i=new Function(r.variable||"obj","_",s)}catch(t){throw t.source=s,t}var l=function(t){return i.call(this,t,_)},c=r.variable||"obj";return l.source="function("+c+"){\n"+s+"}",l}})}),define("skylark-langx-funcs/main",["./funcs"],function(t){return t}),define("skylark-langx-funcs",["skylark-langx-funcs/main"],function(t){return t}),define("skylark-langx-async/Deferred",["skylark-langx-arrays","skylark-langx-funcs","skylark-langx-objects"],function(t,r,e){"use strict";var n=Symbol?Symbol():"__pglisteners",i=Symbol?Symbol():"__pgnotifies",o=Array.prototype.slice,a=r.proxy,s=t.makeArray,u=e.result,l=e.mixin;l(Promise.prototype,{always:function(t){return this.then(t,t),this},done:function(){for(var t=0;t<arguments.length;t++)this.then(arguments[t]);return this},fail:function(t){return this.catch(t),this}});var c=function(){var t=this,r=this.promise=new Promise(function(r,e){t._resolve=r,t._reject=e});f(r,t),this[n]=[],this[i]=[]};function f(t,r){var e={state:function(){return r.isResolved()?"resolved":r.isRejected()?"rejected":"pending"},then:function(t,r,e){return e&&this.progress(e),f(Promise.prototype.then.call(this,t&&function(r){return r&&void 0!==r.__ctx__?t.apply(r.__ctx__,r):t(r)},r&&function(t){return t&&void 0!==t.__ctx__?r.apply(t.__ctx__,t):r(t)}))},progress:function(t){return r[i].forEach(function(r){t(r)}),r[n].push(t),this}};return e.pipe=e.then,l(t,e)}return c.prototype.resolve=function(t){var r=o.call(arguments);return this.resolveWith(null,r)},c.prototype.resolveWith=function(t,r){return(r=r?s(r):[]).__ctx__=t,this._resolve(r),this._resolved=!0,this},c.prototype.notify=function(t){try{return this[i].push(t),this[n].forEach(function(r){return r(t)})}catch(t){this.reject(t)}return this},c.prototype.reject=function(t){var r=o.call(arguments);return this.rejectWith(null,r)},c.prototype.rejectWith=function(t,r){return(r=r?s(r):[]).__ctx__=t,this._reject(r),this._rejected=!0,this},c.prototype.isResolved=function(){return!!this._resolved},c.prototype.isRejected=function(){return!!this._rejected},c.prototype.then=function(t,r,e){var n=u(this,"promise");return n.then(t,r,e)},c.prototype.progress=function(t){var r=u(this,"promise");return r.progress(t)},c.prototype.catch=function(t){var r=u(this,"promise");return r.catch(t)},c.prototype.done=function(){var t=u(this,"promise");return t.done.apply(t,arguments)},c.prototype.fail=function(t){var r=u(this,"promise");return r.fail(t)},c.all=function(t){var r=new c;return Promise.all(t).then(r.resolve.bind(r),r.reject.bind(r)),u(r,"promise")},c.first=function(t){return f(Promise.race(t))},c.when=function(t,r,e,n){var i=t&&"function"==typeof t.then,o=i&&t instanceof Promise;if(!i)return arguments.length>1?r?r(t):t:(new c).resolve(t);if(!o){var s=new c(t.cancel);t.then(a(s.resolve,s),a(s.reject,s),s.notify),t=s.promise}return r||e||n?t.then(r,e,n):t},c.reject=function(t){var r=new c;return r.reject(t),r.promise},c.immediate=c.resolve=function(t){var r=new c;return r.resolve.apply(r,arguments),r.promise},c}),define("skylark-langx-klass/klass",["skylark-langx-ns/ns","skylark-langx-types","skylark-langx-objects","skylark-langx-arrays"],function(t,r,e,n){var i=n.uniq,o=e.has,a=e.mixin,s=r.isArray,u=r.isDefined;var l=function(){function t(){return this._construct?this._construct.apply(this,arguments):this.init?this.init.apply(this,arguments):void 0}return function e(n,l,c,f){s(l)&&(f=c,c=l,l=null),l=l||Object,u(c)&&!s(c)&&(f=c,c=!1);var p=l;c&&(c=function(t,r){var e=[];return r.forEach(function(t){if(o(t,"__mixins__"))throw new Error("nested mixins");for(var r=[];t;)r.unshift(t),t=t.superclass;e=e.concat(r)}),(e=(e=i(e)).filter(function(r){for(var e=t;e;){if(r===e)return!1;if(o(e,"__mixins__"))for(var n=e.__mixins__,i=0;i<n.length;i++)if(n[i]===r)return!1;e=e.superclass}return!0})).length>0&&e}(p,c)),c&&(p=function(t,r){for(var e=t,n=0;n<r.length;n++){var i=new Function;i.prototype=Object.create(e.prototype),i.__proto__=e,i.superclass=null,a(i.prototype,r[n].prototype),i.prototype.__mixin__=r[n],e=i}return e}(p,c));var h=n.klassName||"",y=new Function("return function "+h+"() {var inst = this, ctor = arguments.callee;if (!(inst instanceof ctor)) {inst = Object.create(ctor.prototype);}return ctor._constructor.apply(inst, arguments) || inst;}")();return y.prototype=Object.create(p.prototype),y.prototype.constructor=y,y.superclass=l,y.__proto__=p,y._constructor||(y._constructor=t),c&&(y.__mixins__=c),y.partial||(y.partial=function(t,e){return function(t,e,n){var i=t.prototype,o=t.superclass.prototype,a=n&&n.noOverrided;n&&n.overrides;for(var s in e)if("constructor"!==s){var u=e[s];"function"==typeof e[s]?i[s]=u._constructor||a||"function"!=typeof o[s]?u:function(t,r,e){return function(){var t=this.overrided;this.overrided=e;var n=r.apply(this,arguments);return this.overrided=t,n}}(0,u,o[s]):r.isPlainObject(u)&&null!==u&&u.get?Object.defineProperty(i,s,u):i[s]=u}return t}(this,t,e)}),y.inherit||(y.inherit=function(t,r,n){return e(t,this,r,n)}),y.partial(n,f),y}}();return t.attach("langx.klass",l)}),define("skylark-langx-klass/main",["./klass"],function(t){return t}),define("skylark-langx-klass",["skylark-langx-klass/main"],function(t){return t}),define("skylark-langx-emitter/Evented",["skylark-langx-ns/ns","skylark-langx-types","skylark-langx-objects","skylark-langx-arrays","skylark-langx-klass"],function(t,r,e,n,i){var o=Array.prototype.slice,a=n.compact,s=r.isDefined,u=r.isPlainObject,l=r.isFunction,c=r.isString,f=r.isEmptyObject,p=e.mixin;function h(t){var r=(""+t).split(".");return{name:r[0],ns:r.slice(1).join(" ")}}var y=i({on:function(t,r,e,n,i,o){var a=this,s=this._hub||(this._hub={});return u(t)?(i=n,each(t,function(t,n){a.on(t,r,e,n,i,o)}),this):(c(r)||l(n)||(i=n,n=e,e=r,r=void 0),l(e)&&(i=n,n=e,e=null),c(t)&&(t=t.split(/\s/)),t.forEach(function(t){var a=h(t),u=a.name,l=a.ns;(s[u]||(s[u]=[])).push({fn:n,selector:r,data:e,ctx:i,ns:l,one:o})}),this)},one:function(t,r,e,n,i){return this.on(t,r,e,n,i,1)},trigger:function(t){if(!this._hub)return this;var r=this;c(t)&&(t=new CustomEvent(t)),Object.defineProperty(t,"target",{value:this});var e=o.call(arguments,1);return e=s(e)?[t].concat(e):[t],[t.type||t.name,"all"].forEach(function(n){var i=h(n),o=i.name,s=i.ns,u=r._hub[o];if(u){for(var l=u.length,c=!1,f=0;f<l;f++){var y=u[f];(!s||y.ns&&y.ns.startsWith(s))&&(t.data?y.data&&(t.data=p({},y.data,t.data)):t.data=y.data||null,y.fn.apply(y.ctx,e),y.one&&(u[f]=null,c=!0))}c&&(r._hub[n]=a(u))}}),this},listened:function(t){var r=(this._hub||(this._events={}))[t]||[];return r.length>0},listenTo:function(t,r,e,n){if(!t)return this;c(e)&&(e=this[e]),n?t.one(r,e,this):t.on(r,e,this);for(var i,o=this._listeningTo||(this._listeningTo=[]),a=0;a<o.length;a++)if(o[a].obj==t){i=o[a];break}i||o.push(i={obj:t,events:{}});var s=i.events,u=s[r]=s[r]||[];return-1==u.indexOf(e)&&u.push(e),this},listenToOnce:function(t,r,e){return this.listenTo(t,r,e,1)},off:function(t,r){var e=this._hub||(this._hub={});return c(t)&&(t=t.split(/\s/)),t.forEach(function(t){var n=h(t),i=n.name,o=n.ns,a=e[i];if(a){var s=[];if(r||o)for(var u=0,l=a.length;u<l;u++)r&&a[u].fn!==r&&a[u].fn._!==r?s.push(a[u]):!o||a[u].ns&&0==a[u].ns.indexOf(o)||s.push(a[u]);s.length?e[i]=s:delete e[i]}}),this},unlistenTo:function(t,r,e){var n=this._listeningTo;if(!n)return this;for(var i=0;i<n.length;i++){var o=n[i];if(!t||t==o.obj){var s=o.events;for(var u in s)if(!r||r==u){for(var l=s[u],c=0;c<l.length;c++)e&&e!=l[i]||(o.obj.off(u,l[i],this),l[i]=null);l=s[u]=a(l),f(l)&&(s[u]=null)}f(s)&&(n[i]=null)}}return n=this._listeningTo=a(n),f(n)&&(this._listeningTo=null),this}});return t.attach("langx.Evented",y)}),define("skylark-net-http/Xhr",["skylark-langx-ns/ns","skylark-langx-types","skylark-langx-objects","skylark-langx-arrays","skylark-langx-funcs","skylark-langx-async/Deferred","skylark-langx-emitter/Evented","./http"],function(skylark,types,objects,arrays,funcs,Deferred,Evented,http){var each=objects.each,mixin=objects.mixin,noop=funcs.noop,isArray=types.isArray,isFunction=types.isFunction,isPlainObject=types.isPlainObject,type=types.type,getAbsoluteUrl=function(t){return a||(a=document.createElement("a")),a.href=t,a.href},a,Xhr=function(){var jsonpID=0,key,name,rscript=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,scriptTypeRE=/^(?:text|application)\/javascript/i,xmlTypeRE=/^(?:text|application)\/xml/i,jsonType="application/json",htmlType="text/html",blankRE=/^\s*$/,XhrDefaultOptions={async:!0,type:"GET",beforeSend:noop,success:noop,error:noop,complete:noop,context:null,global:!0,accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:"application/json",xml:"application/xml, text/xml",html:"text/html",text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0,xhrFields:{withCredentials:!0}};function mimeToDataType(t){if(t&&(t=t.split(";",2)[0]),t){if(t==htmlType)return"html";if(t==jsonType)return"json";if(scriptTypeRE.test(t))return"script";if(xmlTypeRE.test(t))return"xml"}return"text"}function appendQuery(t,r){return""==r?t:(t+"&"+r).replace(/[&?]{1,2}/,"?")}function serializeData(t){t.data=t.data||t.query,t.processData&&t.data&&"string"!=type(t.data)&&(t.data=param(t.data,t.traditional)),!t.data||t.type&&"GET"!=t.type.toUpperCase()||(t.url=appendQuery(t.url,t.data),t.data=void 0)}function serialize(t,r,e,n){var i,o=isArray(r),a=isPlainObject(r);each(r,function(r,s){i=type(s),n&&(r=e?n:n+"["+(a||"object"==i||"array"==i?r:"")+"]"),!n&&o?t.add(s.name,s.value):"array"==i||!e&&"object"==i?serialize(t,s,e,r):t.add(r,s)})}var param=function(t,r){var e=[];return e.add=function(t,r){isFunction(r)&&(r=r()),null==r&&(r=""),this.push(encodeURIComponent(t)+"="+encodeURIComponent(r))},serialize(e,t,r),e.join("&").replace(/%20/g,"+")},Xhr=Evented.inherit({klassName:"Xhr",_request:function(args){var _=this._,self=this,options=mixin({},XhrDefaultOptions,_.options,args),xhr=_.xhr=new XMLHttpRequest;serializeData(options),options.beforeSend&&options.beforeSend.call(this,xhr,options);var dataType=options.dataType||options.handleAs,mime=options.mimeType||options.accepts[dataType],headers=options.headers,xhrFields=options.xhrFields,isFormData=options.data&&options.data instanceof FormData,basicAuthorizationToken=options.basicAuthorizationToken,type=options.type,url=options.url,async=options.async,user=options.user,password=options.password,deferred=new Deferred,contentType=!isFormData&&"application/x-www-form-urlencoded";if(xhrFields)for(name in xhrFields)xhr[name]=xhrFields[name];mime&&mime.indexOf(",")>-1&&(mime=mime.split(",",2)[0]),mime&&xhr.overrideMimeType&&xhr.overrideMimeType(mime);var finish=function(){xhr.onloadend=noop,xhr.onabort=noop,xhr.onprogress=noop,xhr.ontimeout=noop,xhr=null},onloadend=function(){var result,error=!1;if(xhr.status>=200&&xhr.status<300||304==xhr.status||0==xhr.status&&getAbsoluteUrl(url).startsWith("file:")){dataType=dataType||mimeToDataType(options.mimeType||xhr.getResponseHeader("content-type")),result=xhr.responseText;try{"script"==dataType?eval(result):"xml"==dataType?result=xhr.responseXML:"json"==dataType?result=blankRE.test(result)?null:JSON.parse(result):"blob"==dataType?result=Blob([xhrObj.response]):"arraybuffer"==dataType&&(result=xhr.reponse)}catch(t){error=t}error?deferred.reject(error,xhr.status,xhr):deferred.resolve(result,xhr.status,xhr)}else deferred.reject(new Error(xhr.statusText),xhr.status,xhr);finish()},onabort=function(){deferred&&deferred.reject(new Error("abort"),xhr.status,xhr),finish()},ontimeout=function(){deferred&&deferred.reject(new Error("timeout"),xhr.status,xhr),finish()},onprogress=function(t){deferred&&deferred.notify(t,xhr.status,xhr)};if(xhr.onloadend=onloadend,xhr.onabort=onabort,xhr.ontimeout=ontimeout,xhr.onprogress=onprogress,xhr.open(type,url,async,user,password),headers)for(var key in headers){var value=headers[key];"content-type"===key.toLowerCase()?contentType=headers[hdr]:xhr.setRequestHeader(key,value)}return contentType&&!1!==contentType&&xhr.setRequestHeader("Content-Type",contentType),headers&&"X-Requested-With"in headers||xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),basicAuthorizationToken&&xhr.setRequestHeader("Authorization",basicAuthorizationToken),xhr.send(options.data?options.data:null),deferred.promise},abort:function(){var t=this._,r=t.xhr;r&&r.abort()},request:function(t){return this._request(t)},get:function(t){return(t=t||{}).type="GET",this._request(t)},post:function(t){return(t=t||{}).type="POST",this._request(t)},patch:function(t){return(t=t||{}).type="PATCH",this._request(t)},put:function(t){return(t=t||{}).type="PUT",this._request(t)},del:function(t){return(t=t||{}).type="DELETE",this._request(t)},init:function(t){this._={options:t||{}}}});return["request","get","post","put","del","patch"].forEach(function(t){Xhr[t]=function(r,e){var n=new Xhr({url:r});return n[t](e)}}),Xhr.defaultOptions=XhrDefaultOptions,Xhr.param=param,Xhr}();return http.Xhr=Xhr}),define("skylark-net-http/main",["./http","./Xhr"],function(t,r){return t}),define("skylark-net-http",["skylark-net-http/main"],function(t){return t})}(define,require),!isAmd){var skylarkjs=require("skylark-langx/skylark");isCmd?module.exports=skylarkjs:globals.skylarkjs=skylarkjs}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-net-http-all.js.map
